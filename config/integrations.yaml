# Claude Automation System - å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æºè¨­å®š
# Slack, Jira, GitHub APIãªã©ã®å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹è¨­å®š

# Slacké€£æºè¨­å®š
slack:
  enabled: true
  webhook_url: "${SLACK_WEBHOOK_URL}"  # ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—
  default_channel: "#claude-automation"
  
  # ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥è¨­å®š
  channels:
    error: "#claude-errors"
    success: "#claude-success"
    review: "#dev-team"
    critical: "#devops-alerts"
  
  # ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³è¨­å®š
  mention_users:
    error: ["@devops-team", "@on-call"]
    review: ["@developer-team"]
    critical: ["@team-lead", "@devops-team"]
  
  # é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  templates:
    execution_start: |
      ğŸ¤– *Claudeè‡ªå‹•å®Ÿè¡Œé–‹å§‹*
      ğŸ“‹ Issue: #{issue_number} - {issue_title}
      ğŸ”— ãƒªãƒã‚¸ãƒˆãƒª: {repository}
      â° é–‹å§‹æ™‚åˆ»: {start_time}
      ğŸ‘¤ è¦æ±‚è€…: {requested_by}
    
    execution_complete: |
      âœ… *Claudeè‡ªå‹•å®Ÿè¡Œå®Œäº†*
      ğŸ“‹ Issue: #{issue_number} - {issue_title}
      ğŸ”— ä½œæˆPR: #{pr_number}
      â±ï¸ å®Ÿè¡Œæ™‚é–“: {execution_time}
      ğŸ‘€ ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼: {reviewers}
      ğŸ“ [PR ã‚’ç¢ºèª]({pr_url})
    
    execution_error: |
      âŒ *Claudeè‡ªå‹•å®Ÿè¡Œã‚¨ãƒ©ãƒ¼*
      ğŸ“‹ Issue: #{issue_number} - {issue_title}
      ğŸš¨ ã‚¨ãƒ©ãƒ¼: {error_message}
      ğŸ”§ å¯¾å¿œ: {suggested_action}
      ğŸ“ [è©³ç´°ã‚’ç¢ºèª]({issue_url})
  
  # ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š
  interactive:
    enabled: true
    actions:
      - name: "approve"
        text: "âœ… æ‰¿èª"
        style: "primary"
      - name: "reject"
        text: "âŒ å´ä¸‹"
        style: "danger"
      - name: "retry"
        text: "ğŸ”„ å†å®Ÿè¡Œ"
        style: "default"
      - name: "view_details"
        text: "ğŸ“‹ è©³ç´°ç¢ºèª"
        style: "default"

# Jiraé€£æºè¨­å®š
jira:
  enabled: true
  base_url: "${JIRA_BASE_URL}"
  username: "${JIRA_USERNAME}"
  api_token: "${JIRA_API_TOKEN}"
  
  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
  default_project: "DEV"
  project_mapping:
    "nori-ut3g/claude-automation-test": "AUTO"
    "your-organization/*": "ORG"
  
  # Issueè¨­å®š
  issue_type: "Task"
  default_priority: "Medium"
  labels: 
    - "claude-automated"
    - "github-sync"
  
  # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°
  field_mapping:
    summary: "github_issue_title"
    description: |
      h3. GitHub Issue æƒ…å ±
      * *Issueç•ªå·*: #{github_issue_number}
      * *ãƒªãƒã‚¸ãƒˆãƒª*: {github_repository}
      * *ä½œæˆè€…*: {github_author}
      * *ä½œæˆæ—¥æ™‚*: {github_created_at}
      
      h3. å…ƒã®èª¬æ˜
      {github_issue_body}
      
      h3. Claudeå®Ÿè¡Œæƒ…å ±
      * *å®Ÿè¡ŒID*: {execution_id}
      * *é–‹å§‹æ™‚åˆ»*: {execution_start_time}
    
    # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆç’°å¢ƒã«å¿œã˜ã¦èª¿æ•´ï¼‰
    custom_fields:
      github_issue_url: "customfield_10001"
      github_pr_url: "customfield_10002"
      claude_execution_time: "customfield_10003"
  
  # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°
  status_mapping:
    github_to_jira:
      "open": "To Do"
      "in_progress": "In Progress"
      "review": "In Review"
      "merged": "Done"
      "closed": "Done"
    jira_to_github:
      "To Do": "open"
      "In Progress": "in_progress"
      "In Review": "review"
      "Done": "closed"
  
  # ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³è¨­å®š
  transitions:
    start_progress: "21"    # ã€Œé€²è¡Œä¸­ã€ã¸ã®é·ç§»ID
    submit_review: "31"     # ã€Œãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­ã€ã¸ã®é·ç§»ID
    complete: "41"          # ã€Œå®Œäº†ã€ã¸ã®é·ç§»ID

# GitHub APIè¨­å®š
github:
  token: "${GITHUB_TOKEN}"
  api_base: "https://api.github.com"
  
  # APIåˆ¶é™è¨­å®š
  rate_limit:
    max_retries: 3
    retry_delay: 60         # ç§’
    rate_limit_wait: 300    # ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ™‚ã®å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
  
  # PRè¨­å®š
  pr_settings:
    draft: false            # ãƒ‰ãƒ©ãƒ•ãƒˆPRã¨ã—ã¦ä½œæˆ
    auto_merge: false       # è‡ªå‹•ãƒãƒ¼ã‚¸ã‚’æœ‰åŠ¹åŒ–
    delete_branch: true     # ãƒãƒ¼ã‚¸å¾Œã«ãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤
    
  # ã‚³ãƒŸãƒƒãƒˆè¨­å®š
  commit_settings:
    sign_commits: false     # GPGç½²å
    commit_message_template: |
      {type}: {description}
      
      Issue: #{issue_number}
      
      {extended_description}
      
      Co-authored-by: Claude <claude@anthropic.com>
      Automated-by: Claude Automation System
  
  # ãƒ©ãƒ™ãƒ«è¨­å®š
  labels:
    automated_pr: "claude-automated-pr"
    in_progress: "claude-in-progress"
    review_ready: "claude-review-ready"
    error: "claude-error"

# Claudeè¨­å®š
claude:
  # å®Ÿè¡Œè¨­å®š
  execution:
    max_execution_time: 600  # ç§’ï¼ˆ10åˆ†ï¼‰
    max_retries: 2
    retry_delay: 120         # ç§’
    mode: "batch"            # batch, terminal, interactive
  
  # Terminalè‡ªå‹•èµ·å‹•è¨­å®š
  terminal:
    enabled: true
    app: "Terminal"          # Terminal, iTerm, Warp
    auto_detect_complex: true # è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•åˆ¤å®šã—ã¦Terminalå®Ÿè¡Œ
    
    # Terminalèµ·å‹•ã®ãƒˆãƒªã‚¬ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
    trigger_keywords:
      - "@claude-terminal"
      - "@claude-interactive"
      - "@claude-visual"
    
    # Terminalèµ·å‹•ã®ãƒˆãƒªã‚¬ãƒ¼ãƒ©ãƒ™ãƒ«
    trigger_labels:
      - "terminal-execution"
      - "interactive"
      - "complex-task"
    
    # è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã®åˆ¤å®šåŸºæº–
    complexity_threshold: 2  # è¤‡é›‘ã•æŒ‡æ¨™ã®æœ€å°æ•°
    complexity_indicators:
      - "è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«"
      - "multiple files"
      - "æ–°ã—ã„API" 
      - "new API"
      - "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"
      - "database"
      - "ãƒ†ã‚¹ãƒˆ"
      - "test"
      - "ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°"
      - "refactor"
  
  # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¨­å®š
  context:
    max_file_size: 100000    # ãƒã‚¤ãƒˆ
    include_patterns:
      - "*.py"
      - "*.js"
      - "*.ts"
      - "*.java"
      - "*.go"
      - "*.md"
      - "*.yml"
      - "*.yaml"
      - "*.json"
    exclude_patterns:
      - "node_modules/**"
      - "dist/**"
      - "build/**"
      - ".git/**"
      - "*.min.js"
      - "*.min.css"

# ãƒ­ã‚°è¨­å®š
logging:
  level: "INFO"              # DEBUG, INFO, WARN, ERROR
  max_file_size: "10M"       # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º
  max_files: 10              # ä¿æŒã™ã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ•°
  format: "[%datetime%] [%level%] [%component%] %message%"
  
  # ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ¥ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
  components:
    monitor: "INFO"
    event_processor: "DEBUG"
    claude_executor: "INFO"
    slack_client: "INFO"
    jira_client: "DEBUG"
    github_client: "INFO"

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
security:
  # æ©Ÿå¯†æƒ…å ±ã®ãƒã‚¹ã‚­ãƒ³ã‚°
  mask_patterns:
    - "token"
    - "password"
    - "api_key"
    - "secret"
  
  # å®Ÿè¡Œæ¨©é™
  allowed_users:
    - "nori-ut3g"
    - "developer-team"
  
  # å®Ÿè¡Œå¯èƒ½ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  allowed_actions:
    - "create_pr"
    - "update_issue"
    - "add_comment"
    - "create_branch"